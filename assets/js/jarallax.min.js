!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a="undefined"==typeof globalThis?a||self:globalThis).jarallax=b()}(this,function(){"use strict";function b(a){"complete"===document.readyState||"interactive"===document.readyState?a():document.addEventListener("DOMContentLoaded",a,{capture:!0,once:!0,passive:!0})}function e(){k?(!l&&document.body&&(l=document.createElement("div"),l.style.cssText="position: fixed; top: -9999px; left: 0; height: 100vh; width: 0;",document.body.appendChild(l)),q=(l?l.clientHeight:0)||j.innerHeight||document.documentElement.clientHeight):q=j.innerHeight||document.documentElement.clientHeight}function f(){u.length&&(u.forEach((b,d)=>{const{instance:e,oldData:f}=b,g=e.$item.getBoundingClientRect(),a={width:g.width,height:g.height,top:g.top,bottom:g.bottom,wndW:j.innerWidth,wndH:q},h=!f||f.wndW!==a.wndW||f.wndH!==a.wndH||f.width!==a.width||f.height!==a.height,i=h||!f||f.top!==a.top||f.bottom!==a.bottom;u[d].oldData=a,h&&e.onResize(),i&&e.onScroll()}),j.requestAnimationFrame(f))}let h="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window;var j=h;const{navigator:i}=j,k=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(i.userAgent);let l,q;e(),j.addEventListener("resize",e),j.addEventListener("orientationchange",e),j.addEventListener("load",e),b(()=>{e()});const u=[];let m=0;class r{constructor(b,c){const d=this;d.instanceID=m,m+=1,d.$item=b,d.defaults={type:"scroll",speed:.5,imgSrc:null,imgElement:".jarallax-img",imgSize:"cover",imgPosition:"50% 50%",imgRepeat:"no-repeat",keepImg:!1,elementInViewport:null,zIndex:-100,disableParallax:!1,disableVideo:!1,videoSrc:null,videoStartTime:0,videoEndTime:0,videoVolume:0,videoLoop:!0,videoPlayOnlyVisible:!0,videoLazyLoading:!0,onScroll:null,onInit:null,onDestroy:null,onCoverImage:null};const f=d.$item.dataset||{},g={};if(Object.keys(f).forEach(a=>{const b=a.substr(0,1).toLowerCase()+a.substr(1);b&&void 0!==d.defaults[b]&&(g[b]=f[a])}),d.options=d.extend({},d.defaults,g,c),d.pureOptions=d.extend({},d.options),Object.keys(d.options).forEach(a=>{"true"===d.options[a]?d.options[a]=!0:"false"===d.options[a]&&(d.options[a]=!1)}),d.options.speed=Math.min(2,Math.max(-1,parseFloat(d.options.speed))),"string"==typeof d.options.disableParallax&&(d.options.disableParallax=new RegExp(d.options.disableParallax)),d.options.disableParallax instanceof RegExp){const a=d.options.disableParallax;d.options.disableParallax=()=>a.test(i.userAgent)}if("function"!=typeof d.options.disableParallax&&(d.options.disableParallax=()=>!1),"string"==typeof d.options.disableVideo&&(d.options.disableVideo=new RegExp(d.options.disableVideo)),d.options.disableVideo instanceof RegExp){const a=d.options.disableVideo;d.options.disableVideo=()=>a.test(i.userAgent)}"function"!=typeof d.options.disableVideo&&(d.options.disableVideo=()=>!1);let a=d.options.elementInViewport;a&&"object"==typeof a&&void 0!==a.length&&([a]=a),a instanceof Element||(a=null),d.options.elementInViewport=a,d.image={src:d.options.imgSrc||null,$container:null,useImgTag:!1,position:"fixed"},d.initImg()&&d.canInitParallax()&&d.init()}css(a,b){return"string"==typeof b?j.getComputedStyle(a).getPropertyValue(b):(Object.keys(b).forEach(c=>{a.style[c]=b[c]}),a)}extend(a,...b){return a=a||{},Object.keys(b).forEach(c=>{b[c]&&Object.keys(b[c]).forEach(d=>{a[d]=b[c][d]})}),a}getWindowData(){return{width:j.innerWidth||document.documentElement.clientWidth,height:q,y:document.documentElement.scrollTop}}initImg(){const a=this;let b=a.options.imgElement;return b&&"string"==typeof b&&(b=a.$item.querySelector(b)),b instanceof Element||(a.options.imgSrc?(b=new Image,b.src=a.options.imgSrc):b=null),b&&(a.options.keepImg?a.image.$item=b.cloneNode(!0):(a.image.$item=b,a.image.$itemParent=b.parentNode),a.image.useImgTag=!0),!!a.image.$item||(null===a.image.src&&(a.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",a.image.bgImage=a.css(a.$item,"background-image")),a.image.bgImage&&"none"!==a.image.bgImage)}canInitParallax(){return!this.options.disableParallax()}init(){const a=this,b={position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"};let c={pointerEvents:"none",transformStyle:"preserve-3d",backfaceVisibility:"hidden"};if(!a.options.keepImg){const b=a.$item.getAttribute("style");if(b&&a.$item.setAttribute("data-jarallax-original-styles",b),a.image.useImgTag){const b=a.image.$item.getAttribute("style");b&&a.image.$item.setAttribute("data-jarallax-original-styles",b)}}if("static"===a.css(a.$item,"position")&&a.css(a.$item,{position:"relative"}),"auto"===a.css(a.$item,"z-index")&&a.css(a.$item,{zIndex:0}),a.image.$container=document.createElement("div"),a.css(a.image.$container,b),a.css(a.image.$container,{"z-index":a.options.zIndex}),"fixed"===this.image.position&&a.css(a.image.$container,{"-webkit-clip-path":"polygon(0 0, 100% 0, 100% 100%, 0 100%)","clip-path":"polygon(0 0, 100% 0, 100% 100%, 0 100%)"}),a.image.$container.setAttribute("id",`jarallax-container-${a.instanceID}`),a.$item.appendChild(a.image.$container),a.image.useImgTag?c=a.extend({"object-fit":a.options.imgSize,"object-position":a.options.imgPosition,"max-width":"none"},b,c):(a.image.$item=document.createElement("div"),a.image.src&&(c=a.extend({"background-position":a.options.imgPosition,"background-size":a.options.imgSize,"background-repeat":a.options.imgRepeat,"background-image":a.image.bgImage||`url("${a.image.src}")`},b,c))),"opacity"!==a.options.type&&"scale"!==a.options.type&&"scale-opacity"!==a.options.type&&1!==a.options.speed||(a.image.position="absolute"),"fixed"===a.image.position){const b=function(a){const b=[];for(;null!==a.parentElement;)1===(a=a.parentElement).nodeType&&b.push(a);return b}(a.$item).filter(a=>{const b=j.getComputedStyle(a),c=b["-webkit-transform"]||b["-moz-transform"]||b.transform;return c&&"none"!==c||/(auto|scroll)/.test(b.overflow+b["overflow-y"]+b["overflow-x"])});a.image.position=b.length?"absolute":"fixed"}c.position=a.image.position,a.css(a.image.$item,c),a.image.$container.appendChild(a.image.$item),a.onResize(),a.onScroll(!0),a.options.onInit&&a.options.onInit.call(a),"none"!==a.css(a.$item,"background-image")&&a.css(a.$item,{"background-image":"none"}),a.addToParallaxList()}addToParallaxList(){u.push({instance:this}),1===u.length&&j.requestAnimationFrame(f)}removeFromParallaxList(){const a=this;u.forEach((b,c)=>{b.instance.instanceID===a.instanceID&&u.splice(c,1)})}destroy(){const a=this;a.removeFromParallaxList();const b=a.$item.getAttribute("data-jarallax-original-styles");if(a.$item.removeAttribute("data-jarallax-original-styles"),b?a.$item.setAttribute("style",b):a.$item.removeAttribute("style"),a.image.useImgTag){const c=a.image.$item.getAttribute("data-jarallax-original-styles");a.image.$item.removeAttribute("data-jarallax-original-styles"),c?a.image.$item.setAttribute("style",b):a.image.$item.removeAttribute("style"),a.image.$itemParent&&a.image.$itemParent.appendChild(a.image.$item)}a.image.$container&&a.image.$container.parentNode.removeChild(a.image.$container),a.options.onDestroy&&a.options.onDestroy.call(a),delete a.$item.jarallax}clipContainer(){}coverImage(){const b=this,c=b.image.$container.getBoundingClientRect(),d=c.height,{speed:e}=b.options,f="scroll"===b.options.type||"scroll-opacity"===b.options.type;let g=0,h=d,i=0;return f&&(0>e?(g=e*Math.max(d,q),q<d&&(g-=e*(d-q))):g=e*(d+q),1<e?h=Math.abs(g-q):0>e?h=g/e+Math.abs(g):h+=(q-d)*(1-e),g/=2),b.parallaxScrollDistance=g,i=f?(q-h)/2:(d-h)/2,b.css(b.image.$item,{height:`${h}px`,marginTop:`${i}px`,left:"fixed"===b.image.position?`${c.left}px`:"0",width:`${c.width}px`}),b.options.onCoverImage&&b.options.onCoverImage.call(b),{image:{height:h,marginTop:i},container:c}}isVisible(){return this.isElementInViewport||!1}onScroll(b){const i=this,e=i.$item.getBoundingClientRect(),k=e.top,n=e.height,a={};let l=e;if(i.options.elementInViewport&&(l=i.options.elementInViewport.getBoundingClientRect()),i.isElementInViewport=0<=l.bottom&&0<=l.right&&l.top<=q&&l.left<=j.innerWidth,!b&&!i.isElementInViewport)return;const o=Math.max(0,k),m=Math.max(0,n+k),c=Math.max(0,-k),p=Math.max(0,k+n-q),d=Math.max(0,n-(k+n-q)),g=Math.max(0,-k+q-n),s=1-2*((q-k)/(q+n));let f=1;if(n<q?f=1-(c||p)/n:m<=q?f=m/q:d<=q&&(f=d/q),"opacity"!==i.options.type&&"scale-opacity"!==i.options.type&&"scroll-opacity"!==i.options.type||(a.transform="translate3d(0,0,0)",a.opacity=f),"scale"===i.options.type||"scale-opacity"===i.options.type){let b=1;0>i.options.speed?b-=i.options.speed*f:b+=i.options.speed*(1-f),a.transform=`scale(${b}) translate3d(0,0,0)`}if("scroll"===i.options.type||"scroll-opacity"===i.options.type){let b=i.parallaxScrollDistance*s;"absolute"===i.image.position&&(b-=k),a.transform=`translate3d(0,${b}px,0)`}i.css(i.image.$item,a),i.options.onScroll&&i.options.onScroll.call(i,{section:e,beforeTop:o,beforeTopEnd:m,afterTop:c,beforeBottom:p,beforeBottomEnd:d,afterBottom:g,visiblePercent:f,fromViewportCenter:s})}onResize(){this.coverImage()}}const n=function(b,c,...d){("object"==typeof HTMLElement?b instanceof HTMLElement:b&&"object"==typeof b&&null!==b&&1===b.nodeType&&"string"==typeof b.nodeName)&&(b=[b]);const f=b.length;for(let e,g=0;g<f;g+=1)if("object"==typeof c||void 0===c?b[g].jarallax||(b[g].jarallax=new r(b[g],c)):b[g].jarallax&&(e=b[g].jarallax[c].apply(b[g].jarallax,d)),void 0!==e)return e;return b};n.constructor=r;const d=j.jQuery;if(void 0!==d){const a=function(...a){Array.prototype.unshift.call(a,this);const b=n.apply(j,a);return"object"==typeof b?this:b};a.constructor=n.constructor;const b=d.fn.jarallax;d.fn.jarallax=a,d.fn.jarallax.noConflict=function(){return d.fn.jarallax=b,this}}return b(()=>{n(document.querySelectorAll("[data-jarallax]"))}),n});